---
subsys:
  name: minio
  type: bosh-deployment

input_resources:
  - name: minio-boshrelease
    type: git
    uri: https://github.com/minio/minio-boshrelease.git
    version: b7fb0f8 # '2018-06-08T03-49-38Z' release, as of June 18th, 2018


main_deployment_file: minio-boshrelease/manifests/manifest-dist-example.yaml


operations_files:
  10.local:
    - rename-deployment
    - rename-network
    - pin-versions
    - customize-access-creds
    - scale-vms-and-disks
    - randomize-az-placement
    - remove-default-bucket-seeding # should come last


deployment_vars:
  deployment_name: easyfoundry-minio


  # User-facing settings

  minio_internal_hostname: minio.easyfoundry.internal
  minio_server_accesskey: minio


  # Scaling

  minio_instances: 4 # a minimum or 4 is required when using erasure coding (the default)
  persistent_disk_type: 2GB


  # Versions

  minio_version: 2018-06-08T03-49-38Z
  minio_sha1: 3a5ae84f8b2be9ee640d545c489633e36c0674dd

  # stemcell_os:      # imported below
  # stemcell_version: # imported below
  # stemcell_sha1:    # imported below


  # Reference declarations

  network_name: default # injected in runtime config


imported_vars:
  - subsys: cf
    imports:

      # Versions

      - name: stemcell_os
        from: depl-vars
        path: /stemcell_os
      - name: stemcell_version
        from: depl-vars
        path: /stemcell_version
      - name: stemcell_sha1
        from: depl-vars
        path: /stemcell_sha1

  # Plumbery

  # - subsys: minio
  #   imports:
  #     # This "auto-import" is a workaround trick to have variables that use
  #     # other deployment variables in their values.
  #     - name: dns_alias
  #       from: depl-vars
  #       value: "minio.((network_name)).((deployment_name)).bosh"
