---
subsys:
  name: logsearch
  type: bosh-deployment
  deploy_after: cf

input_resources:
  - name: logsearch-boshrelease
    type: git
    uri: https://github.com/cloudfoundry-community/logsearch-boshrelease.git
    version: v209.0.0


# main_deployment_file: ./conf/logsearch-deployment.yml
main_deployment_file: logsearch-boshrelease/deployment/logsearch-deployment.yml

operations_files:
  10.logsearch-boshrelease:
    - deployment/operations/scale-to-one-az
    - deployment/operations/cerebro
  20.local:
    - rename-deployment
    - pin-stemcell
    - set-versions
    - scale-vms
    - cf-integration
    - bosh-lite-support
    - scale-disks
    - fix-errands-vms-names # must be last


deployment_vars:
  deployment_name: easyfoundry-logsearch


  # User-facing settings

  system_domain: logsearch.easyfoundry.prototyp.it

  elasticsearch_heap_size: 500M
  logstash_heap_size: 500M


  # Versions

  logsearch_version: "209.0.0"
  logsearch_sha1: 76433fb23850e7237951312315e27da0bdf10f5e

  logsearch_for_cloudfoundry_version: "207.0.0"
  logsearch_for_cloudfoundry_sha1: e6f740707042d29a1ac09a7481cf72b805b1469d

  # stemcell_os:      # imported below
  # stemcell_version: # imported below
  # stemcell_sha1:    # imported below


  # Reference declarations

  network_name: default


imported_vars:
  - subsys: cf
    imports:

      # Versions

      - name: stemcell_os
        from: depl-vars
        path: /stemcell_os
      - name: stemcell_version
        from: depl-vars
        path: /stemcell_version
      - name: stemcell_sha1
        from: depl-vars
        path: /stemcell_sha1


      # CF Plumbery

      - name: cf_deployment_name
        from: depl-vars
        path: /deployment_name

      - name: cf_admin_password
        from: depl-creds
        path: /cf_admin_password

      - name: uaa_admin_client_secret
        from: depl-creds
        path: /uaa_admin_client_secret
