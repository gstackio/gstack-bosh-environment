---

# General user-facing settings

- path: /instance_groups/name=shield/jobs/name=core/properties/domain
  type: replace
  value: ((shield_domain))

- path: /variables/name=shield-tls/options/alternative_names/-
  type: replace
  value: <%= shield.instance.address %>

- path: /variables/name=shield-tls/options/alternative_names/-
  type: replace
  value: "*.shield.((network_name)).((deployment_name)).bosh"

- path: /variables/name=shield-tls/options/alternative_names/-
  type: replace
  value: ((shield_domain))

- path: /variables/name=vault-tls/options/alternative_names/-
  type: replace
  value: "*.vault.((network_name)).((deployment_name)).bosh"


- path: /instance_groups/name=shield/jobs/name=core/properties/port?
  type: replace
  value: ((shield_port))


- path: /instance_groups/name=shield/jobs/name=core/properties/core?/color
  type: replace
  value: ((shield_color))



# Networks

- path: /instance_groups/name=shield/networks/name=default
  type: replace
  value:
    name: ((network_name))

- path: /variables/name=shield-tls/options/alternative_names/1
  type: remove # remove reference to ((static_ip))



# Plumbery

- path: /name
  type: replace
  value: ((deployment_name))

# Workaround for SHIELD core not exposing the correct IP in its 'shield' link
- path: /instance_groups/name=shield/jobs/name=shield-agent/consumes/shield?
  type: replace
  value:
    instances:
      - address: ((shield_internal_hostname)) # 10.244.204.61
    properties:
      domain: ((shield_internal_hostname)) # 10.244.204.61
      port: ((shield_port))
